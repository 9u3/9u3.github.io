<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Industrialist RP Calculator</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f2f5;
            color: #333;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        h1 {
            text-align: center;
            color: #2c3e50;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }
        select, input[type="number"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            box-sizing: border-box;
        }
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .checkbox-group input {
            width: auto;
        }
        .results {
            margin-top: 30px;
            padding: 20px;
            background-color: #e8f4f8;
            border-radius: 8px;
            border-left: 5px solid #3498db;
        }
        .result-item {
            margin-bottom: 10px;
            font-size: 18px;
            display: flex;
            justify-content: space-between;
        }
        .result-value {
            font-weight: bold;
            color: #2980b9;
        }
        .cap-gain { color: #27ae60; }
        .cap-loss { color: #c0392b; }
        
        .sdc-section {
            border-top: 1px solid #eee;
            padding-top: 20px;
            margin-top: 20px;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>

    <h1>Industrialist RP Calculator</h1>
    
    <div class="container">
        <div class="form-group">
            <label for="item1">Input Item 1</label>
            <select id="item1"></select>
        </div>

        <div class="form-group">
            <label for="item2">Input Item 2</label>
            <select id="item2"></select>
        </div>

        <div class="form-group">
            <label for="stations">Number of Research Station 3s</label>
            <input type="number" id="stations" value="1" min="1">
        </div>

        <div class="form-group checkbox-group">
            <input type="checkbox" id="useSDC">
            <label for="useSDC" style="margin-bottom: 0;">Use Satellite Dish Controllers (SDC)</label>
        </div>

        <div id="sdcControls" class="sdc-section hidden">
            <div class="form-group">
                <label for="sdcCount">Number of SDCs</label>
                <input type="number" id="sdcCount" value="1" min="1">
            </div>
            <div class="form-group">
                <label for="sdcFluid">SDC Fluid</label>
                <select id="sdcFluid"></select>
            </div>
        </div>

        <div class="results">
            <div class="result-item">
                <span>RP Cap Factor:</span>
                <span id="rpCapFactor" class="result-value">-</span>
            </div>
            <div class="result-item">
                <span>Cap Effect:</span>
                <span id="capEffect" class="result-value">-</span>
            </div>
            <div class="result-item">
                <span>Base Research Speed:</span>
                <span id="baseSpeed" class="result-value">0.00 RP/s</span>
            </div>
            <div id="sdcResult" class="result-item hidden">
                <span>SDC Boost:</span>
                <span id="sdcBoost" class="result-value">+0.00 RP/s</span>
            </div>
            <div class="result-item" style="margin-top: 15px; font-size: 22px; border-top: 1px solid #ccc; padding-top: 10px;">
                <span>Total Research Speed:</span>
                <span id="totalSpeed" class="result-value">0.00 RP/s</span>
            </div>
        </div>
    </div>

    <script>
        // Embedded Items Data
        const itemsData = {
  "10 Karat Gold": { "value": 300, "rp_multiplier": 1, "fluid_rp_value": null },
  "12 Karat Gold": { "value": 500, "rp_multiplier": 1, "fluid_rp_value": null },
  "16x Microchip": { "value": 17600, "rp_multiplier": null, "fluid_rp_value": null },
  "18 Karat Gold": { "value": 800, "rp_multiplier": 1, "fluid_rp_value": null },
  "24 Karat Gold": { "value": 1200, "rp_multiplier": 1, "fluid_rp_value": null },
  "2x Microchip": { "value": 4000, "rp_multiplier": 1, "fluid_rp_value": null },
  "2x64x Microchip": { "value": 100000, "rp_multiplier": null, "fluid_rp_value": null },
  "32x Microchip": { "value": 22000, "rp_multiplier": null, "fluid_rp_value": null },
  "3x64x Microchip": { "value": 250000, "rp_multiplier": null, "fluid_rp_value": null },
  "4x Microchip": { "value": 8400, "rp_multiplier": null, "fluid_rp_value": null },
  "4x64x Microchip": { "value": 375000, "rp_multiplier": null, "fluid_rp_value": null },
  "5x64x Microchip": { "value": 1000000, "rp_multiplier": null, "fluid_rp_value": null },
  "64x Microchip": { "value": 28220, "rp_multiplier": null, "fluid_rp_value": null },
  "6x64x Microchip": { "value": 2000000, "rp_multiplier": null, "fluid_rp_value": null },
  "7x64x Microchip": { "value": 3000000, "rp_multiplier": null, "fluid_rp_value": null },
  "8 Karat Gold": { "value": 160, "rp_multiplier": 1, "fluid_rp_value": null },
  "8x Microchip": { "value": 13200, "rp_multiplier": null, "fluid_rp_value": null },
  "8x64x Microchip": { "value": 5000000, "rp_multiplier": null, "fluid_rp_value": null },
  "Acetic Acid": { "value": 14.5, "rp_multiplier": 7, "fluid_rp_value": 7 },
  "Alumina": { "value": 100, "rp_multiplier": 1, "fluid_rp_value": null },
  "Alumina Dust": { "value": 90, "rp_multiplier": 1, "fluid_rp_value": null },
  "Aluminum Ingot": { "value": 800, "rp_multiplier": 65, "fluid_rp_value": null },
  "Bauxite Residue": { "value": 50, "rp_multiplier": 1, "fluid_rp_value": null },
  "Black Dye": { "value": 8.7, "rp_multiplier": 1, "fluid_rp_value": null },
  "Brass Ingot": { "value": 80, "rp_multiplier": 35, "fluid_rp_value": null },
  "Cat": { "value": 20000, "rp_multiplier": 1, "fluid_rp_value": null },
  "Chair": { "value": 1029.5, "rp_multiplier": 30, "fluid_rp_value": null },
  "Charged Lithium-Ion Battery": { "value": 4000, "rp_multiplier": 1, "fluid_rp_value": null },
  "Cheap Water Bottle": { "value": 130.5, "rp_multiplier": 5, "fluid_rp_value": null },
  "Chlorine": { "value": 0.2, "rp_multiplier": 0.5, "fluid_rp_value": null },
  "Chunk Plank": { "value": 3.48, "rp_multiplier": 1, "fluid_rp_value": null },
  "Coal": { "value": 5.22, "rp_multiplier": 1, "fluid_rp_value": null },
  "Coke Fuel": { "value": 18, "rp_multiplier": 9, "fluid_rp_value": null },
  "Concentrated Salt Solution": { "value": 2, "rp_multiplier": 1, "fluid_rp_value": 1 },
  "Condensate": { "value": 0.1, "rp_multiplier": 0, "fluid_rp_value": null },
  "Copper Drill Head": { "value": 20000, "rp_multiplier": 25, "fluid_rp_value": null },
  "Copper Ingot": { "value": 26.68, "rp_multiplier": 1.5, "fluid_rp_value": null },
  "Copper Mix": { "value": 3, "rp_multiplier": 1, "fluid_rp_value": null },
  "Copper Plate": { "value": 32.86, "rp_multiplier": 6, "fluid_rp_value": null },
  "Copper Powder": { "value": 7, "rp_multiplier": 1, "fluid_rp_value": null },
  "Copper Wire": { "value": 7.31, "rp_multiplier": 1, "fluid_rp_value": null },
  "Crankshaft": { "value": 754, "rp_multiplier": 35, "fluid_rp_value": null },
  "Crude Diesel": { "value": 13.05, "rp_multiplier": 1, "fluid_rp_value": null },
  "Crude Oil": { "value": 11.6, "rp_multiplier": 0.2, "fluid_rp_value": 0.2 },
  "Crushed Bauxite": { "value": 75, "rp_multiplier": 1, "fluid_rp_value": null },
  "Cut Oak Log": { "value": 3.48, "rp_multiplier": 1, "fluid_rp_value": null },
  "Deep Earth Fragment": { "value": 200, "rp_multiplier": 1, "fluid_rp_value": null },
  "Diesel": { "value": 30.45, "rp_multiplier": 2, "fluid_rp_value": 2 },
  "Dirty Lithium Sulfate": { "value": 60, "rp_multiplier": 1, "fluid_rp_value": null },
  "Distilled Water": { "value": 1, "rp_multiplier": 0.3, "fluid_rp_value": 0.3 },
  "Dynamite": { "value": 90, "rp_multiplier": 25, "fluid_rp_value": null },
  "Electric Motor": { "value": 4500, "rp_multiplier": 200, "fluid_rp_value": null },
  "Electromagnet": { "value": 950, "rp_multiplier": 1, "fluid_rp_value": null },
  "Ethanol": { "value": 5.8, "rp_multiplier": 2, "fluid_rp_value": 7 },
  "Ethylene": { "value": 14.5, "rp_multiplier": 0.2, "fluid_rp_value": null },
  "Exhaust": { "value": -0.5, "rp_multiplier": 0, "fluid_rp_value": null },
  "Ferroaluminum Alloy Ingot": { "value": 2000, "rp_multiplier": 1, "fluid_rp_value": null },
  "Ferroaluminum Magnet": { "value": 8500, "rp_multiplier": 120, "fluid_rp_value": null },
  "Filter": { "value": 20, "rp_multiplier": 1, "fluid_rp_value": null },
  "Filtered Water": { "value": 0.55, "rp_multiplier": 0.2, "fluid_rp_value": 0.2 },
  "Fracking Oil": { "value": 1, "rp_multiplier": 0.2, "fluid_rp_value": null },
  "Galvanized Steel": { "value": 123, "rp_multiplier": 33, "fluid_rp_value": null },
  "Gasoline": { "value": 40.6, "rp_multiplier": 7.5, "fluid_rp_value": null },
  "GasolineE10": { "value": 57, "rp_multiplier": 13, "fluid_rp_value": 12 },
  "Gear": { "value": 98.6, "rp_multiplier": 20, "fluid_rp_value": null },
  "Gearbox": { "value": 2552, "rp_multiplier": 50, "fluid_rp_value": null },
  "Glass": { "value": 80, "rp_multiplier": 14, "fluid_rp_value": null },
  "Gold Ingot": { "value": 4250, "rp_multiplier": 70, "fluid_rp_value": null },
  "Gold Wire": { "value": 200, "rp_multiplier": 1, "fluid_rp_value": null },
  "Graphite-Iron Electrode": { "value": 80, "rp_multiplier": 1, "fluid_rp_value": null },
  "Graphite-Zinc Electrode": { "value": 60, "rp_multiplier": 1, "fluid_rp_value": null },
  "Gravel": { "value": 3, "rp_multiplier": 0.1, "fluid_rp_value": null },
  "Gunpowder": { "value": 70, "rp_multiplier": 1, "fluid_rp_value": null },
  "Heavy Oil": { "value": 5, "rp_multiplier": 0.2, "fluid_rp_value": null },
  "High Pressure Steam": { "value": 0.03, "rp_multiplier": 0, "fluid_rp_value": null },
  "Hot Crude Oil": { "value": 0.14, "rp_multiplier": 0, "fluid_rp_value": null },
  "Hydrochloric Acid": { "value": 80, "rp_multiplier": 10, "fluid_rp_value": 10 },
  "Hydrogen": { "value": 0.02, "rp_multiplier": 0.5, "fluid_rp_value": null },
  "Hydrogen Sulfide": { "value": 8, "rp_multiplier": 0, "fluid_rp_value": null },
  "Insulated Wire": { "value": 40, "rp_multiplier": 1, "fluid_rp_value": null },
  "Iron Coil": { "value": 43.85, "rp_multiplier": 4, "fluid_rp_value": null },
  "Iron Drill Head": { "value": 145000, "rp_multiplier": 30, "fluid_rp_value": null },
  "Iron Ingot": { "value": 65.54, "rp_multiplier": 1, "fluid_rp_value": null },
  "Iron Mix": { "value": 10, "rp_multiplier": 1, "fluid_rp_value": null },
  "Iron Plate": { "value": 70.18, "rp_multiplier": 1, "fluid_rp_value": null },
  "Iron Plate^2": { "value": 295.8, "rp_multiplier": 1, "fluid_rp_value": null },
  "Iron Powder": { "value": 15, "rp_multiplier": 1, "fluid_rp_value": null },
  "LNG": { "value": 174, "rp_multiplier": 2, "fluid_rp_value": 2 },
  "Lead Ingot": { "value": 25, "rp_multiplier": 1, "fluid_rp_value": null },
  "Leaded Gasoline": { "value": 112, "rp_multiplier": 23, "fluid_rp_value": 20 },
  "Light Oil": { "value": 7, "rp_multiplier": 0.1, "fluid_rp_value": null },
  "Liquid Aluminum": { "value": 200, "rp_multiplier": 0, "fluid_rp_value": null },
  "Liquid Brass": { "value": 30, "rp_multiplier": 0, "fluid_rp_value": null },
  "Liquid Copper": { "value": 7.54, "rp_multiplier": 0, "fluid_rp_value": null },
  "Liquid Glass": { "value": 10, "rp_multiplier": 1, "fluid_rp_value": null },
  "Liquid Gold": { "value": 1000, "rp_multiplier": 0, "fluid_rp_value": null },
  "Liquid Iron": { "value": 23.2, "rp_multiplier": 0, "fluid_rp_value": null },
  "Liquid Lead": { "value": 5, "rp_multiplier": 0, "fluid_rp_value": null },
  "Liquid Sulfur": { "value": 12, "rp_multiplier": 0, "fluid_rp_value": null },
  "Lithium Battery Pack": { "value": 85000, "rp_multiplier": 180, "fluid_rp_value": null },
  "Lithium Brine": { "value": 25, "rp_multiplier": 1, "fluid_rp_value": null },
  "Lithium Carbonate": { "value": 200, "rp_multiplier": 40, "fluid_rp_value": null },
  "Lithium Ore": { "value": 10, "rp_multiplier": 1, "fluid_rp_value": null },
  "Lithium Sulfate": { "value": 100, "rp_multiplier": 1, "fluid_rp_value": null },
  "Logic Plate": { "value": 65, "rp_multiplier": 1, "fluid_rp_value": null },
  "Low Pressure Steam": { "value": 0.03, "rp_multiplier": 0, "fluid_rp_value": null },
  "MEG": { "value": 2.9, "rp_multiplier": 0.2, "fluid_rp_value": null },
  "Machine Oil": { "value": 29, "rp_multiplier": 4, "fluid_rp_value": 4 },
  "Medium Earth Fragment": { "value": 120, "rp_multiplier": 1, "fluid_rp_value": null },
  "Molten Ferroaluminum Alloy": { "value": 1250, "rp_multiplier": 1, "fluid_rp_value": null },
  "Molten Purple Gold": { "value": 580, "rp_multiplier": 1, "fluid_rp_value": null },
  "Nails": { "value": 2.9, "rp_multiplier": 1, "fluid_rp_value": null },
  "Naphtha": { "value": 15.6, "rp_multiplier": 0.1, "fluid_rp_value": null },
  "Oak Log": { "value": 5.8, "rp_multiplier": 1, "fluid_rp_value": null },
  "Oil Bottle": { "value": 208.8, "rp_multiplier": 20, "fluid_rp_value": null },
  "Oxygen": { "value": 0.01, "rp_multiplier": 0.5, "fluid_rp_value": null },
  "PTA": { "value": 2.9, "rp_multiplier": 0.2, "fluid_rp_value": null },
  "Packed Present": { "value": 300, "rp_multiplier": null, "fluid_rp_value": null },
  "Paper": { "value": 14.5, "rp_multiplier": 7, "fluid_rp_value": null },
  "Paraxylene": { "value": 14.5, "rp_multiplier": 0.2, "fluid_rp_value": null },
  "Plank^2": { "value": 40.6, "rp_multiplier": 1, "fluid_rp_value": null },
  "Planks": { "value": 13.05, "rp_multiplier": 5, "fluid_rp_value": null },
  "Plastic Bottle": { "value": 72.5, "rp_multiplier": 30, "fluid_rp_value": null },
  "Plastic Casing": { "value": 145, "rp_multiplier": 7, "fluid_rp_value": null },
  "Plastic Pellets": { "value": 0.87, "rp_multiplier": 25, "fluid_rp_value": null },
  "Poor Quality Diesel": { "value": 21.75, "rp_multiplier": 1.5, "fluid_rp_value": 1.5 },
  "Powdered Tungsten": { "value": 150, "rp_multiplier": 1, "fluid_rp_value": null },
  "Powdered Tungsten Carbide": { "value": 210, "rp_multiplier": 1, "fluid_rp_value": null },
  "Present Box": { "value": 173, "rp_multiplier": 1, "fluid_rp_value": null },
  "Purple Gold Ingot": { "value": 20000, "rp_multiplier": 100, "fluid_rp_value": null },
  "Raw Copper": { "value": 5.51, "rp_multiplier": 1, "fluid_rp_value": null },
  "Raw Gas": { "value": 0.03, "rp_multiplier": 0, "fluid_rp_value": null },
  "Raw Iron": { "value": 5.8, "rp_multiplier": 1, "fluid_rp_value": null },
  "Raw Lead": { "value": 10, "rp_multiplier": 1, "fluid_rp_value": null },
  "Raw Zinc": { "value": 5, "rp_multiplier": 1, "fluid_rp_value": null },
  "Refined Diesel": { "value": 40.6, "rp_multiplier": 3, "fluid_rp_value": 3 },
  "Refined Diesel Bottle": { "value": 449.5, "rp_multiplier": 15, "fluid_rp_value": null },
  "Refined Gas": { "value": 0.29, "rp_multiplier": 0.01, "fluid_rp_value": 0.01 },
  "Residue": { "value": -5.8, "rp_multiplier": 0, "fluid_rp_value": null },
  "Residue Bottle": { "value": 0, "rp_multiplier": 0, "fluid_rp_value": null },
  "Rich Soil": { "value": 5, "rp_multiplier": 1, "fluid_rp_value": null },
  "Rock": { "value": 4, "rp_multiplier": 1, "fluid_rp_value": null },
  "Rubber": { "value": 19.4, "rp_multiplier": 90, "fluid_rp_value": null },
  "Sand": { "value": 5, "rp_multiplier": 0.1, "fluid_rp_value": null },
  "Semiconductor": { "value": 650, "rp_multiplier": 30, "fluid_rp_value": null },
  "Shallow Earth Fragment": { "value": 30, "rp_multiplier": 1, "fluid_rp_value": null },
  "Silicon": { "value": 50, "rp_multiplier": 1, "fluid_rp_value": null },
  "Sodium Carbonate": { "value": 8, "rp_multiplier": 1, "fluid_rp_value": null },
  "Sodium Hydroxide Solution": { "value": 10, "rp_multiplier": 1, "fluid_rp_value": null },
  "Soil": { "value": 2, "rp_multiplier": 0.1, "fluid_rp_value": null },
  "Steam": { "value": 0.03, "rp_multiplier": 0, "fluid_rp_value": null },
  "Steel Coil": { "value": 75, "rp_multiplier": 1, "fluid_rp_value": null },
  "Steel Drill Head": { "value": 190000, "rp_multiplier": 125, "fluid_rp_value": null },
  "Steel Ingot": { "value": 48.72, "rp_multiplier": 1, "fluid_rp_value": null },
  "Steel Plate": { "value": 89.9, "rp_multiplier": 18, "fluid_rp_value": null },
  "Steel Rod": { "value": 92.8, "rp_multiplier": 1, "fluid_rp_value": null },
  "Sulfur": { "value": 20, "rp_multiplier": 12, "fluid_rp_value": null },
  "Sulfur Dioxide": { "value": 2, "rp_multiplier": 0, "fluid_rp_value": null },
  "Sulfur Trioxide": { "value": 2.5, "rp_multiplier": 0, "fluid_rp_value": null },
  "Sulfuric Acid": { "value": 65, "rp_multiplier": 4, "fluid_rp_value": null },
  "Table Salt": { "value": 4, "rp_multiplier": 1, "fluid_rp_value": null },
  "Tetraethyllead": { "value": 21, "rp_multiplier": 7, "fluid_rp_value": null },
  "Tire": { "value": 2000, "rp_multiplier": 40, "fluid_rp_value": null },
  "Tire Rim": { "value": 1800, "rp_multiplier": 1, "fluid_rp_value": null },
  "Toy": { "value": 101.5, "rp_multiplier": 1, "fluid_rp_value": null },
  "Treated Raw Copper": { "value": 6, "rp_multiplier": 1, "fluid_rp_value": null },
  "Treated Raw Iron": { "value": 8, "rp_multiplier": 1, "fluid_rp_value": null },
  "Treated Rock": { "value": 15, "rp_multiplier": 1, "fluid_rp_value": null },
  "Tungsten Carbide Drill Head": { "value": 800000, "rp_multiplier": 225, "fluid_rp_value": null },
  "Tungsten Carbide Plate": { "value": 600, "rp_multiplier": 70, "fluid_rp_value": null },
  "Uncharged Lithium-Ion Battery": { "value": 2000, "rp_multiplier": 1, "fluid_rp_value": null },
  "Uranium": { "value": 8000, "rp_multiplier": null, "fluid_rp_value": null },
  "Water": { "value": 0.23, "rp_multiplier": 0, "fluid_rp_value": 0 },
  "Water Bottle": { "value": 174, "rp_multiplier": 20, "fluid_rp_value": null },
  "Water-Free Gas": { "value": 0.14, "rp_multiplier": 0, "fluid_rp_value": null },
  "Zinc": { "value": 20, "rp_multiplier": 1, "fluid_rp_value": null },
  "Zinc Sulfate": { "value": 10, "rp_multiplier": 1, "fluid_rp_value": null },
  "Boric Acid": { "value": 0, "rp_multiplier": null, "fluid_rp_value": 12 },
  "Ammonia": { "value": 0, "rp_multiplier": null, "fluid_rp_value": 15 }
};

        // DOM Elements
        const item1Select = document.getElementById('item1');
        const item2Select = document.getElementById('item2');
        const stationsInput = document.getElementById('stations');
        const useSDCCheckbox = document.getElementById('useSDC');
        const sdcControls = document.getElementById('sdcControls');
        const sdcCountInput = document.getElementById('sdcCount');
        const sdcFluidSelect = document.getElementById('sdcFluid');
        
        const rpCapFactorEl = document.getElementById('rpCapFactor');
        const capEffectEl = document.getElementById('capEffect');
        const baseSpeedEl = document.getElementById('baseSpeed');
        const sdcResultEl = document.getElementById('sdcResult');
        const sdcBoostEl = document.getElementById('sdcBoost');
        const totalSpeedEl = document.getElementById('totalSpeed');

        // Initialize Dropdowns
        function init() {
            const sortedKeys = Object.keys(itemsData).sort();
            
            // Populate Item Selects
            sortedKeys.forEach(key => {
                const option1 = new Option(key, key);
                const option2 = new Option(key, key);
                item1Select.add(option1);
                item2Select.add(option2);
            });

            // Populate Fluid Select
            sortedKeys.forEach(key => {
                if (itemsData[key].fluid_rp_value !== null) {
                    const option = new Option(`${key} (RP: ${itemsData[key].fluid_rp_value})`, key);
                    sdcFluidSelect.add(option);
                }
            });

            // Set defaults if available
            if (item1Select.options.length > 0) item1Select.selectedIndex = 0;
            if (item2Select.options.length > 0) item2Select.selectedIndex = 0;
            if (sdcFluidSelect.options.length > 0) sdcFluidSelect.selectedIndex = 0;

            calculate();
        }

        // Calculation Logic
        function calculate() {
            const item1Name = item1Select.value;
            const item2Name = item2Select.value;
            const stations = parseInt(stationsInput.value) || 1;
            const useSDC = useSDCCheckbox.checked;
            const sdcCount = parseInt(sdcCountInput.value) || 0;
            const sdcFluidName = sdcFluidSelect.value;

            if (!item1Name || !item2Name) return;

            const item1 = itemsData[item1Name];
            const item2 = itemsData[item2Name];

            // 1. Calculate RP Cap
            const avgValue = (item1.value + item2.value) / 2;
            let rpCap = 0;
            if (avgValue >= 600) {
                rpCap = (Math.log(avgValue / 600) / Math.log(4)) + 1;
            } else {
                rpCap = Math.log2(1 + (avgValue / 600));
            }

            // Display Cap Results
            rpCapFactorEl.textContent = rpCap.toFixed(4);
            if (rpCap >= 1) {
                const gain = (rpCap - 1) * 100;
                capEffectEl.textContent = `Gain: ${gain.toFixed(2)}%`;
                capEffectEl.className = 'result-value cap-gain';
            } else {
                const loss = (1 - rpCap) * 100;
                capEffectEl.textContent = `Loss: ${loss.toFixed(2)}%`;
                capEffectEl.className = 'result-value cap-loss';
            }

            // 2. Calculate Base RP Speed
            let mult1 = item1.rp_multiplier || 0;
            let mult2 = item2.rp_multiplier || 0;

            // Fluids cannot be used in Research Station 3
            if (item1.fluid_rp_value !== null) mult1 = 0;
            if (item2.fluid_rp_value !== null) mult2 = 0;

            let n = mult1 + mult2;
            
            if (item1Name === item2Name) {
                n *= 0.7; // 30% penalty
            }
            
            const totalN = n * stations;
            const baseSpeed = 2 * Math.pow(totalN, 0.6);
            
            baseSpeedEl.textContent = `${baseSpeed.toFixed(2)} RP/s`;

            // 3. Calculate SDC Boost
            let sdcBoost = 0;
            if (useSDC && sdcFluidName && sdcCount > 0) {
                const fluidVal = itemsData[sdcFluidName].fluid_rp_value || 0;
                const sdcN = fluidVal * sdcCount;
                sdcBoost = 0.78 * baseSpeed * Math.log10(sdcN + 1);
                
                sdcResultEl.classList.remove('hidden');
                sdcBoostEl.textContent = `+${sdcBoost.toFixed(2)} RP/s`;
            } else {
                sdcResultEl.classList.add('hidden');
            }

            // 4. Total Speed
            const totalSpeed = baseSpeed + sdcBoost;
            totalSpeedEl.textContent = `${totalSpeed.toFixed(2)} RP/s`;
        }

        // Event Listeners
        item1Select.addEventListener('change', calculate);
        item2Select.addEventListener('change', calculate);
        stationsInput.addEventListener('input', calculate);
        
        useSDCCheckbox.addEventListener('change', (e) => {
            if (e.target.checked) {
                sdcControls.classList.remove('hidden');
            } else {
                sdcControls.classList.add('hidden');
            }
            calculate();
        });
        
        sdcCountInput.addEventListener('input', calculate);
        sdcFluidSelect.addEventListener('change', calculate);

        // Start
        init();

    </script>
</body>
</html>